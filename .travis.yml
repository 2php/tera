language: cpp
compiler: gcc
addons:
  apt:
    packages:
      - gdb
      - apport

before_install:
    - ulimit -c unlimited -S
    - ulimit -a

install:
    - bash -x build.sh origin

script:
    - make check
    - bash -x ft_test.sh

after_failure:
    - find . -name 'core.*' -print
    - for core_file in $(find test_output -name 'core*' -print); do
          echo "${core_file}";
          tmp=${core_file#*core.}; exe_name=${tmp%.*};
          echo "${core_file} is generated by ${exe_name}"
          gdb ${exe_name} ${core_file} -ex "thread apply all bt" -ex "set pagination 0" -batch;
      done

